


@using Montcrest.Web.ViewModels.Hr
@model List<HrApplicantViewModel>

@{
    ViewData["Title"] = "Applicants";
}

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
    :root {
        --primary: #4f46e5;
        --primary-hover: #4338ca;
        --bg-body: #f8fafc;
        --text-main: #1e293b;
        --text-muted: #64748b;
    }

    body {
        background-color: var(--bg-body);
        font-family: 'Inter', sans-serif;
        color: var(--text-main);
    }

    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
    }

    .page-title {
        font-weight: 700;
        font-size: 1.5rem;
        color: var(--text-main);
        letter-spacing: -0.025em;
    }

    /* Card Styling */
    .table-card {
        background: white;
        border-radius: 12px;
        border: 1px solid #e2e8f0;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        overflow: hidden;
    }

    /* Modern Table */
    .table-modern {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 0;
    }

    .table-modern thead th {
        background-color: #f1f5f9;
        color: var(--text-muted);
        font-weight: 600;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        padding: 1rem 1.5rem;
        border-bottom: 1px solid #e2e8f0;
        text-align: left;
    }

    .table-modern tbody tr {
        border-bottom: 1px solid #f1f5f9;
        transition: background 0.2s;
    }

    .table-modern tbody tr:hover {
        background-color: #f8fafc;
    }

    .table-modern td {
        padding: 1.25rem 1.5rem;
        font-size: 0.9rem;
        vertical-align: middle;
    }

    /* Soft Badges */
    .badge-soft {
        padding: 0.4em 0.8em;
        border-radius: 9999px;
        font-weight: 600;
        font-size: 0.75rem;
        display: inline-flex;
        align-items: center;
    }

    .bg-soft-warning { background-color: #fef3c7; color: #92400e; }
    .bg-soft-primary { background-color: #e0e7ff; color: #3730a3; }
    .bg-soft-info { background-color: #e0f2fe; color: #075985; }
    .bg-soft-success { background-color: #dcfce7; color: #166534; }
    .bg-soft-danger { background-color: #fee2e2; color: #991b1b; }
    .bg-soft-secondary { background-color: #f1f5f9; color: #475569; }

    /* Buttons */
    .btn-action {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
        font-weight: 500;
        border-radius: 8px;
        transition: all 0.2s;
        text-decoration: none;
    }

    .btn-review { background: #f1f5f9; color: #475569; border: 1px solid #e2e8f0; }
    .btn-review:hover { background: #e2e8f0; }

    .btn-exam { background: var(--primary); color: white; border: none; }
    .btn-exam:hover { background: var(--primary-hover); transform: translateY(-1px); }

    .btn-sync {
        background: transparent;
        color: #f59e0b;
        border: 1px solid #f59e0b;
    }
    .btn-sync:hover { background: #f59e0b; color: white; }

    /* Alerts */
    .alert-modern {
        border: none;
        border-radius: 10px;
        padding: 1rem 1.25rem;
        margin-bottom: 1.5rem;
        font-weight: 500;
    }

    .candidate-info div:first-child {
        font-weight: 600;
        color: var(--text-main);
    }
    .candidate-info div:last-child {
        font-size: 0.8rem;
        color: var(--text-muted);
    }
</style>

<div class="container-fluid py-4">
    <div class="page-header">
        <h2 class="page-title">Applicants Management</h2>
        <div class="text-muted small">Total Applicants: @Model.Count</div>
    </div>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-modern alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle-fill me-2"></i> @TempData["Success"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    @if (TempData["Error"] != null)
    {
        <div class="alert alert-modern alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i> @TempData["Error"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <div class="table-card">
        @if (!Model.Any())
        {
            <div class="p-5 text-center">
                <img src="https://illustrations.popsy.co/gray/empty-folder.svg" style="width: 150px;" class="mb-3" />
                <p class="text-muted">No applicants found in the system.</p>
            </div>
        }
        else
        {
            <table class="table-modern">
                <thead>
                    <tr>
                        <th>Candidate</th>
                        <th>Contact Info</th>
                        <th>Applied On</th>
                        <th>Status</th>
                        <th>Action</th>
                        <th>Assessment</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var a in Model)
                    {
                        <tr>
                            <td>
                                <div class="candidate-info">
                                    <div>@a.CandidateName</div>
                                    <div>ID: #@a.ApplicationId</div>
                                </div>
                            </td>
                            <td>
                                <div>@a.Email</div>
                                <div class="text-muted small">@a.MobileNumber</div>
                            </td>
                            <td>
                                <span class="text-muted">@a.AppliedOn.ToString("dd MMM yyyy")</span>
                            </td>
                            <td>
                                @if (a.Status == "Applied")
                                {
                                    <span class="badge-soft bg-soft-warning">Applied</span>
                                }
                                else if (a.Status == "Reviewed")
                                {
                                    <span class="badge-soft bg-soft-primary">Reviewed</span>
                                }
                                else if (a.Status == "ExamSent")
                                {
                                    <span class="badge-soft bg-soft-info">Exam Sent</span>
                                }
                                else if (a.Status == "ExamCompleted")
                                {
                                    <span class="badge-soft bg-soft-secondary">Exam Completed</span>
                                }
                                else if (a.Status == "Selected")
                                {
                                    <span class="badge-soft bg-soft-success">Selected</span>
                                }
                                else if (a.Status == "Rejected")
                                {
                                    <span class="badge-soft bg-soft-danger">Rejected</span>
                                }
                                else
                                {
                                    <span class="badge-soft bg-soft-secondary">@a.Status</span>
                                }
                            </td>
                            <td>
                                <div class="d-flex gap-2">
                                    <a class="btn-action btn-review"
                                       href="/Hr/Review?applicationId=@a.ApplicationId">
                                        Review
                                    </a>

                                    @if (a.Status == "Reviewed")
                                    {
                                        <a class="btn-action btn-exam"
                                           href="/Hr/ConductExam?applicationId=@a.ApplicationId">
                                            Conduct Exam
                                        </a>
                                    }
                                </div>
                            </td>
                            <td>
                                <form asp-action="SyncScore" asp-controller="Hr" method="post">
                                    <input type="hidden" name="applicationId" value="@a.ApplicationId" />
                                    <input type="hidden" name="technologyId" value="@Context.Request.Query["technologyId"]" />

                                    <button type="submit" class="btn-action btn-sync">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path><path d="M3 22v-6h6"></path><path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path></svg>
                                        Sync Score
                                    </button>
                                </form>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    </div>
</div>